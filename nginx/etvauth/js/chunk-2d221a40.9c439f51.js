(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d221a40"],{cae1:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("el-main",[i("div",{staticStyle:{display:"flex","margin-bottom":"15px"}},[i("el-page-header",{attrs:{content:"旷视授权"},on:{back:t.goBack}}),i("div",{staticStyle:{"margin-left":"15px","font-size":"14px",display:"flex","align-items":"center"}},[t._v("( "+t._s(t.cuName)+" )")])],1),i("div",{staticClass:"tableTopBar borderNotBottom"},[i("div",{staticClass:"topFrom",staticStyle:{"margin-top":"10px","margin-right":"10px","min-width":"0"}},[i("div",{staticClass:"topFrom-item"},[i("label",[t._v("设备Mac:")]),i("div",{staticClass:"topFrom-item-input"},[i("el-input",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini",placeholder:"设备Mac"},model:{value:t.maNo,callback:function(e){t.maNo=e},expression:"maNo"}})],1)]),i("div",{staticClass:"topFrom-item"},[i("label",[t._v("授权状态：")]),i("div",{staticClass:"topFrom-item-input"},[i("el-select",{attrs:{size:"mini",placeholder:""},model:{value:t.maAuthState,callback:function(e){t.maAuthState=e},expression:"maAuthState"}},t._l(t.options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),i("div",{staticClass:"topFrom-item"},[i("label",[t._v("授权来源：")]),i("div",{staticClass:"topFrom-item-input"},[i("el-select",{attrs:{size:"mini",placeholder:""},model:{value:t.maAuthOs,callback:function(e){t.maAuthOs=e},expression:"maAuthOs"}},t._l(t.sources,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),i("div",{staticClass:"topFrom-item"},[i("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.searchList}},[t._v("搜索")])],1)]),i("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.activationtArr}},[t._v("批量激活")]),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.addBackList}},[t._v("加入黑名单")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"1"===t.role,expression:"role==='1'"}],attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.batchClear("0")}}},[t._v("批量清除")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"1"===t.role,expression:"role==='1'"}],attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.batchClear("1")}}},[t._v("批量删除")]),"1"===t.queryType?i("el-button",{directives:[{name:"show",rawName:"v-show",value:"1"===t.role,expression:"role==='1'"}],attrs:{type:"primary",size:"mini"},on:{click:t.onAddGro}},[t._v("导出 ")]):t._e()],1)]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,border:"",height:"calc(100% - 49px)","header-row-class-name":"tableHead",size:"small"},on:{"selection-change":t.selectM}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),t._l(t.tableType,(function(t,e){return i("el-table-column",{key:e,attrs:{formatter:t.formatter,prop:t.prop,align:"center","min-width":t.minWidth,label:t.label,width:t.width}})}))],2),i("div",{staticClass:"tablePage borderNotTop"},[i("el-pagination",{attrs:{background:"","page-size":20,"current-page":t.currentPage,layout:"total,prev, pager, next",total:t.total},on:{"current-change":t.onpage}})],1)],1),i("el-dialog",{attrs:{title:"离线授权",visible:t.authdialogVisible,width:"30%"},on:{"update:visible":function(e){t.authdialogVisible=e}}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("label",{staticStyle:{flex:"0 0 90px"},attrs:{for:"authPwd"}},[t._v("操作密码")]),i("el-input",{attrs:{size:"mini",type:"password",id:"authPwd",placeholder:"请输入操作密码"},model:{value:t.operatePwd,callback:function(e){t.operatePwd=e},expression:"operatePwd"}})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.authdialogVisible=!1,t.operatePwd=""}}},[t._v("取 消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.confirmAuth}},[t._v("确 定")])],1)]),t.addRes?i("el-dialog",{attrs:{title:t.title,"before-close":t.closeDialog,"close-on-click-modal":!1,visible:t.dialogVisible,width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"addResData",attrs:{size:"mini",model:t.addResData,rules:t.addResRules,"label-width":"125px","label-position":"left"}},[i("el-form-item",{attrs:{label:"mac",prop:"machineNo"}},[i("el-input",{attrs:{maxlength:"20"},model:{value:t.addResData.machineNo,callback:function(e){t.$set(t.addResData,"machineNo",e)},expression:"addResData.machineNo"}})],1),i("el-form-item",{attrs:{label:"备注",prop:"remark"}},[i("el-input",{attrs:{maxlength:"20"},model:{value:t.addResData.remark,callback:function(e){t.$set(t.addResData,"remark",e)},expression:"addResData.remark"}})],1),i("el-form-item",{attrs:{label:"操作密码",prop:"operatePwd"}},[i("el-input",{attrs:{type:"password"},model:{value:t.addResData.operatePwd,callback:function(e){t.$set(t.addResData,"operatePwd",e)},expression:"addResData.operatePwd"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.cancelAdd("addResData")}}},[t._v("取消")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.submit("addResData")}}},[t._v("确定")])],1)],1):t._e()],1)},s=[],n={name:"dayMeeting",data:function(){return{role:this.$cookie.get("roleId"),queryType:this.$route.query.type,operatePwd:"",selectoperatePwdId:"",authdialogVisible:!1,selectValue:"",options:[{label:"已授权",value:"1"},{label:"已激活",value:"0"},{label:"未激活",value:"-1"}],sources:[{label:"Android",value:"1"},{label:"Linux",value:"2"}],maNo:"",maAuthOs:"",maAuthState:"",title:"",addRes:!1,dialogVisible:!0,currentPage:1,total:0,loading:!1,list:[],selectMeetings:[],tableType:[{prop:"maNo",label:"设备Mac"},{prop:"maSystmeVersion",label:"固件版本"},{prop:"maActiveKey",label:"授权密匙"},{prop:"maRemark",label:"备注"},{prop:"maAuthTime",label:"授权时间"},{prop:"maAuthOs",label:"授权来源",formatter:this.maAuthOsThumb},{prop:"maCreateTime",label:"创建时间"},{prop:"maAuthState",label:"授权状态",formatter:this.maAuthStateThumb},{label:"操作",minWidth:"280",formatter:this.thumb}],addResData:{machineNo:"",id:"",operatePwd:"",cuId:"",remark:""},addResRules:{machineNo:[{required:!0,message:"请输入设备Mac",trigger:"blue"}],operatePwd:[{required:!0,message:"请输入操作密码",trigger:"blue"}]},cuName:this.$route.query.cuName}},created:function(){this.getResList()},methods:{addBackList:function(){var t=this;if(this.selectMeetings.length){console.log(this.selectMeetings);var e=this.selectMeetings.map((function(t){return t.maNo})).join(",");this.$post("/addKSAuthBlackList.json",{cuId:this.$route.query.cuId,machineNo:e}).then((function(e){0===e.code?(t.$elementMessage(e.msg,"success"),t.getResList()):t.$elementMessage(e.msg,"error")}))}else this.$elementMessage("请选择要操作的数据","error")},batchClear:function(t){var e=this;if(this.selectMeetings.length){var i="0"===t?"/updateCleanKsData.json":"/deleteBatchKsData.json",a=this.selectMeetings.map((function(t){return t.id}));this.$prompt("请输入操作密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputErrorMessage:"输入不能为空",inputValidator:function(t){if(!t)return"输入不能为空"},type:"warning"}).then((function(t){var s=t.value;console.log(s),e.$post(i,{ids:a,operatePwd:s}).then((function(t){0===t.code?(e.$elementMessage(t.msg,"success"),e.getResList()):e.$elementMessage(t.msg,"error")}))})).catch((function(){}))}else this.$elementMessage("请选择要操作的数据","error")},maAuthOsThumb:function(t,e,i){return 1===i?"Android":"Linux"},maAuthStateThumb:function(t,e,i){return"1"===i?"已授权":"0"===t.maActivState?"已激活":"未激活"},confirmAuth:function(){var t=this;this.$post("updateOfflineAuthKuangshiMachine.json",{ksauthId:this.selectoperatePwdId,operatePwd:this.operatePwd}).then((function(e){t.authdialogVisible=!1,t.operatePwd="",0===e.code?t.$elementMessage(e.msg,"success"):t.$elementMessage(e.msg,"error")}))},submit:function(t){var e=this;this.$refs[t].validate((function(i){i&&e.$post("/updateKuangShiInfo.json",e.addResData).then((function(i){0===i.code?(e.$elementMessage(i.msg,"success"),e.cancelAdd(t),e.getResList()):e.$elementMessage(i.msg,"error")})).catch((function(t){e.$elementMessage(t,"error")}))}))},closeDialog:function(){this.$refs["addResData"].resetFields(),this.addRes=!1},cancelAdd:function(t){this.$refs[t].resetFields(),this.addRes=!1},goBack:function(){this.$router.go(-1)},searchList:function(){this.currentPage=1,this.getResList()},getResList:function(){var t=this;this.$route.query.type;this.loading=!0,this.$get("/selectAuthMachineList.json",{cuId:this.$route.query.cuId,type:"1",machineNo:this.maNo,pageSize:20,authOS:this.maAuthOs,authState:this.maAuthState,pageNum:this.currentPage}).then((function(e){t.loading=!1,0===e.code&&(t.list=e.data.list,t.total=e.data.total)}))},onAddGro:function(){this.title="新增客户",this.addRes=!0},onEditGro:function(t){this.title="编辑",this.addRes=!0,this.addResData.machineNo=t.maNo,this.addResData.id=t.id,this.addResData.cuId=t.maCuId},activationt:function(t){var e=this;this.$confirm("请再次确认你要授权的mac号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$post("/updateAuthState.json",{ids:t}).then((function(t){0===t.code?(e.$elementMessage(t.msg,"success"),e.getResList()):e.$elementMessage(t.msg,"error")}))}))},activationtArr:function(){if(this.selectMeetings.length){for(var t=0;t<this.selectMeetings.length;t++)if(""===this.selectMeetings[t].maNo||null===this.selectMeetings[t].maNo||"-1"===this.selectMeetings[t].maAuthState)return void this.$elementMessage("设备不能重复激活或MAC为空","error");var e=this.selectMeetings.map((function(t){return t.id}));this.activationt(e)}else this.$elementMessage("请选择要操作的数据","error")},onpage:function(t){this.currentPage=t,this.getResList()},selectM:function(t){this.selectMeetings=t},toAutht:function(t){this.selectoperatePwdId=t.id,this.authdialogVisible=!0},thumb:function(t,e,i){var a=this,s=this.$createElement;return"1"===t.maAuthState?s("div",[s("el-button",{attrs:{size:"mini",disabled:!0,type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.activationt([t.id])}}},["激活"]),s("el-button",{attrs:{size:"mini",disabled:!0,type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.toAutht(t)}}},["离线授权"])]):"0"===t.maActivState?s("div",[s("el-button",{attrs:{size:"mini",disabled:!0,type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.activationt([t.id])}}},["激活"]),s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.toAutht(t)}}},["离线授权"])]):null!==t.maNo&&""!==t.maNo?s("div",[s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.activationt([t.id])}}},["激活"]),s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.toAutht(t)}}},["离线授权"])]):s("div",[s("el-button",{attrs:{size:"mini",disabled:!0,type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.activationt([t.id])}}},["激活"]),s("el-button",{attrs:{size:"mini",disabled:!0,type:"primary",icon:"el-icon-edit"},on:{click:function(){return a.toAutht(t)}}},["离线授权"])])}},components:{}},o=n,l=i("2877"),r=Object(l["a"])(o,a,s,!1,null,"34b26c88",null);e["default"]=r.exports}}]);